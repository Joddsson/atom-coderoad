"use strict";function taskProgress(e,t){return e/t*100}var __extends=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},__decorate=this&&this.__decorate||function(e,t,a,n){var i,s=arguments.length,r=3>s?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,a,n);else for(var o=e.length-1;o>=0;o--)(i=e[o])&&(r=(3>s?i(r):s>3?i(t,a,r):i(t,a))||r);return s>3&&r&&Object.defineProperty(t,a,r),r},__metadata=this&&this.__metadata||function(e,t){return"object"==typeof Reflect&&"function"==typeof Reflect.metadata?Reflect.metadata(e,t):void 0},React=require("react"),ReactDOM=require("react-dom"),react_redux_1=require("react-redux"),Action=require("../../actions/actions"),_components_1=require("../_components"),classNames=require("classnames"),iconPath="material-ui/lib/svg-icons/",material_ui_1=require("material-ui"),colors_1=require("material-ui/lib/styles/colors"),Complete=require(iconPath+"toggle/check-box"),Incomplete=require(iconPath+"toggle/check-box-outline-blank"),RunningTest=require(iconPath+"toggle/indeterminate-check-box"),Info=require(iconPath+"action/info"),InfoOutline=require(iconPath+"action/info-outline"),style={height:"100%",width:"100%"},default_1=function(e){function t(){e.call(this),this.state={hintPos:-1,taskPos:0}}return __extends(t,e),t.prototype.componentDidUpdate=function(){console.log("update");var e=this.props.taskPosition;e>0&&ReactDOM.findDOMNode(this.refs["task"+e]).scrollIntoView(),this.state.taskPos!==e&&(this.state.hintPos=-1),this.state.hintPos>-1&&ReactDOM.findDOMNode(this.refs["hint"+this.state.hintPos]).scrollIntoView()},t.prototype.visibleTasks=function(){return this.props.tasks.slice(0,this.props.taskPosition+1)},t.prototype.getIcon=function(e,t){return t>e?React.createElement(Complete,{color:colors_1.green500}):e===t&&this.props.runTests?React.createElement(RunningTest,{color:colors_1.orange500}):React.createElement(Incomplete,null)},t.prototype.displayHint=function(){var e=this.props.tasks[this.props.taskPosition].hints.length-1;this.state.hintPos<e&&this.setState({hintPos:this.state.hintPos+=1})},t.prototype.hintsShown=function(e){return this.state.hintPos>-1&&e.hints&&e.hints.length>0?e.hints.slice(0,this.state.hintPos+1):null},t.prototype.render=function(){var e=this,t=this.props.page,a=this.visibleTasks(),n=this.props.taskPosition,i=n>=a.length;return React.createElement(material_ui_1.Paper,{style:style,zDepth:1,className:"cr-page"},React.createElement(material_ui_1.Card,null,React.createElement(material_ui_1.CardHeader,{title:t.title,subtitle:t.description}),React.createElement(material_ui_1.CardText,null,React.createElement(_components_1.MarkdownText,{text:t.explanation}))),React.createElement(material_ui_1.Divider,null),React.createElement(material_ui_1.List,{subheader:"Tasks",className:"cr-tasks",ref:"tasks"},a.map(function(t,i){var s=i===n,r=i>n,o=n>i,c=i>=a.length-1,l=e.hintsShown(t);return console.log(l),React.createElement("div",null,React.createElement(material_ui_1.ListItem,{ref:"task"+i,className:classNames({"cr-task":!0,isCompletedTask:o,isCurrentTask:s,isDisabledTask:r})},React.createElement("span",{className:"cr-task-checkbox"},e.getIcon(i,n)),React.createElement("span",{className:"cr-task-index"},i+1,"."),React.createElement("div",{className:"cr-task-description"},React.createElement(_components_1.MarkdownText,{text:t.description}))),s&&l?l.map(function(e,t){return React.createElement(material_ui_1.ListItem,{className:"cr-task-hint",ref:"hint"+t},React.createElement("div",{"class":"cr-task-hint-box"},React.createElement("span",{className:"cr-task-hint-index"},t+1,"."),React.createElement("div",{className:"cr-task-hint-description"},React.createElement(_components_1.MarkdownText,{text:e}))))}):null,c?null:React.createElement(material_ui_1.Divider,null))})),React.createElement("section",{className:"cr-page-toolbar"},React.createElement(material_ui_1.LinearProgress,{mode:"determinate",value:taskProgress(n,a.length),style:{height:"6px"}}),React.createElement(material_ui_1.Toolbar,null,a[this.props.taskPosition].hints&&a[this.props.taskPosition].hints.length?React.createElement(material_ui_1.ToolbarGroup,{"float":"left"},this.state.hintPos<=a[this.props.taskPosition].hints.length-2?React.createElement(material_ui_1.FlatButton,{className:"cr-task-showHint",icon:React.createElement(InfoOutline,null),onClick:this.displayHint.bind(this)}):React.createElement(material_ui_1.FlatButton,{className:"cr-task-showHint-disabled",icon:React.createElement(Info,null),disabled:!0})):null,React.createElement(material_ui_1.ToolbarGroup,{"float":"right"},i?React.createElement(material_ui_1.RaisedButton,{label:"Continue",primary:!0,onClick:this.props.callNextPage}):React.createElement(material_ui_1.RaisedButton,{label:"Run",secondary:!0,onClick:this.props.callRunTests})))))},t=__decorate([react_redux_1.connect(null,function(e,t){return{callNextPage:function(){return e(Action.nextPage())},callRunTests:function(){return e(Action.runTests())},toggleLog:function(){return e(Action.toggleLog())}}}),__metadata("design:paramtypes",[])],t)}(React.Component);Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=default_1;