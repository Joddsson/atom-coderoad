function runner(e){var t=_.flatten(e),s={cwd:editor_1.dir()};null==s.env&&(s.env=Object.create(process.env)),s.env.ATOM_SHELL_INTERNAL_RUN_AS_NODE=1;var r="darwin"===process.platform?path.resolve(process.resourcesPath,"..","Frameworks","Atom Helper.app","Contents","MacOS","Atom Helper"):process.execPath,o=spawn(r,["/usr/local/bin/mocha","--bail","--reporter="+path.join(__dirname,"reporter")].concat(t),s);o.stdout.on("data",function(t){var s=JSON.parse(t),r=null;if(s.failedAt){var o=s.failures[0],a=findFailureTestPosition(e,s.failedAt);r=a===_base_1.store.getState().taskPosition?{pass:!1,taskPosition:a,msg:o.msg,desc:o.body}:{pass:!1,taskPosition:a}}else r={pass:!0,taskPosition:e.length},_base_1.store.dispatch(Action.pageComplete());_base_1.store.dispatch(Action.testResult(r))}),o.stderr.on("data",function(e){console.log("test error "+e)}),o.on("close",function(e){_base_1.store.dispatch(Action.testComplete())})}function findFailureTestPosition(e,t){for(var s=0;s<e.length;s++)if(e[s].indexOf(t)>-1)return s}var path=require("path"),_base_1=require("../../../_base"),Action=require("../../../actions/actions"),editor_1=require("../../../atom/editor"),_=require("lodash"),spawn=require("child_process").spawn;Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=runner;