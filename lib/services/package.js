function configTestString(t,e,o){return o=t.testDir?path.join(global.coderoad.dir,"node_modules",e,t.testDir,o):path.join(global.coderoad.dir,"node_modules",e,o),t.testSuffix&&(o+=t.testSuffix),o}var path=require("path"),setGlobals_1=require("./setGlobals"),_=require("lodash"),PackageService=function(){function t(){this.packageName="",this.data={project:{},chapters:[]},this.config={}}return t.prototype.selectPackage=function(t){var e=path.join(global.coderoad.dir,"node_modules",t);this.config=require(path.join(e,"package.json")),this.data=require(path.join(e,this.config.main)),this.packageName=t,setGlobals_1.setGlobals(this.config)},t.prototype.page=function(t){var e=_.cloneDeep(this.data.chapters[t.chapter].pages[t.page]);return e},t.prototype.getConfig=function(){return this.config},t.prototype.configTaskTests=function(t){var e=this,o=this.config.coderoad;return t.map(function(t){return t.tests=t.tests.map(function(t){return _.isString(t)?[].concat(configTestString(o,e.packageName,t)):void console.error("Invalid task test",t)}),t})},t.prototype.getTasks=function(t){var e=this.page(t).tasks||[];return e=this.configTaskTests(e)},t.prototype.getPage=function(t){var e=this.page(t);return{title:e.title,description:e.description,explanation:e.explanation,completed:e.completed||!1}},t.prototype.getSavedPosition=function(){return{chapter:0,page:0}},t.prototype.getSavedRoute=function(){return"progress"},t.prototype.getNextPosition=function(t){var e=this.data.chapters;return t.page<e[t.chapter].pages.length-1?{chapter:t.chapter,page:t.page+1}:t.chapter<e.length-1?{chapter:t.chapter+1,page:0}:(store.dispatch(Action.projectComplete()),t)},t.prototype.getProject=function(){return this.data.project},t.prototype.getProgress=function(){var t=this.data.chapters;return{completed:!1,chapters:t.map(function(t){return{title:t.title,description:t.description,completed:t.completed||!1,pages:t.pages.map(function(t){return{title:t.title,description:t.description,completed:t.completed||!1}})}})}},t}();Object.defineProperty(exports,"__esModule",{value:!0}),exports["default"]=new PackageService;